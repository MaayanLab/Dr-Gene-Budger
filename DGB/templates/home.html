{% extends "layout.html" %}
{% block content %}
<div class="container">
  <div class="row">
    <form action="/DGB/" method="post">
      <fieldset>
        {{ form.hidden_tag() }}
        <div id = "the-basics">
          Gene Symbol
          <br>
          <div id="custom-search-input">
           <div class="input-group col-md-12">
             <input type="text" class="search-query form-control typeahead" placeholder="Gene Symbol" />
             <span class="input-group-btn">
               <button class="btn btn-danger" type="button">
                 <span class=" glyphicon glyphicon-search"></span>
               </button>
             </span>
           </div>
         </div>
          {{ form.symbol(class="typeahead", placeholder="Gene Symbol") }}
          <br>
        </div>

        <div class="radio">
          {{ form.expression.label }} {{ form.expression }}<br>
        </div>

        <div class="radio">
          {{ form.dataset.label }} {{ form.dataset }}<br>
        </div>

        <div>
          {{ form.submit }}
        </div>
      </fieldset>
    </form>
  </div>
</div>

<script>
  $.getJSON('/DGB/static/js/array.json', function(arr){
      var substringMatcher = function(strs) {
        return function findMatches(q, cb) {
          var matches, substringRegex;

          // an array that will be populated with substring matches
          matches = [];

          // regex used to determine if a string contains the substring `q`
          substrRegex = new RegExp(q, 'i');

          // iterate through the pool of strings and for any string that
          // contains the substring `q`, add it to the `matches` array
          $.each(strs, function(i, str) {
            if (substrRegex.test(str)) {
              matches.push(str);
            }
          });

          cb(matches);
        };
      };

      $('#the-basics .typeahead').typeahead({
        hint: true,
        highlight: true,
        minLength: 1,
      },
      {
        name: 'arr',
        source: substringMatcher(arr),
        limit: 8
      });
  });
</script>

{% endblock %}
